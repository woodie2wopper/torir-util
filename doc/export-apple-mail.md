# export-apple-mail AppleMailをテキストファイルとして出力する（ファイル名に日時とタイトルの一部）

## 機能
- macOS Mailで選択したメールをAppleScriptで自動的にテキストファイル化し、ファイル名に日時と件名を含めて保存する

📄 ファイル内容:
- 本文（プレーンテキスト）
- ファイル名に YYMMDD_HHMMSS_件名.txt を使用
- 入力ディレクトリ内のexport-mailフォルダに保存（変更可）

## 使用方法

## AppleScriptで選択メールを保存する方法
- MailSaver.applescriptをスクリプトエディターで開く。
- Mailでセーブしたいファイルを選択する（複数可能）
- スクリプトの実行方法
  1. AppleScriptエディタ（スクリプトエディタ）を開く
  2. `src/MailSaver.applescript`を開く
  3. スクリプトを実行するには以下のいずれかの方法を使用:
   - スクリプトエディタの「実行」ボタンをクリック
   - ショートカットキー `Command + R` を使用
   - スクリプトを保存後、Finderから直接ダブルクリック

## 文字コードの変更とファイル名に日付と時間を追加する
```
./bin/export-apple-mail.py -i 保存されたメールのディレクトリ [-o 出力ディレクトリ]
```
- 出力ディレクトリを指定しない場合、入力ディレクトリ内のexport-mailフォルダに保存されます
- ファイル名の形式: YYMMDD_HHMMSS_件名.txt
  - 例: 240507_085726_Re-NFC-Detect.txt

## 注意事項
- メールが選択されていない場合はエラーメッセージが表示されます
- ファイル名に使用できない文字（\/*?:"<>|()[]{}）は自動的に削除されます
- 件名は20文字までに制限されます
- 連続するハイフンは1つにまとめられます
- ファイル名の先頭と末尾のハイフンは削除されます
- エラーが発生した場合は、エラーメッセージが表示されます
